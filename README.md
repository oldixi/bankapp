# bankapp

## Функциональность
Микросервисное приложение «Банк» — это приложение с веб-интерфейсом, которое позволяет пользователю (клиенту банка):
* регистрироваться в системе по логину и паролю (заводить аккаунт);
* добавлять счета в различных валютах;
* класть виртуальные деньги на счёт пользователя и снимать их;
* переводить деньги между своими счетами с учётом конвертации в различные валюты;
* переводить деньги на другой счёт с учётом конвертации в различные валюты.<br>

Приложение состоит из следующих микросервисов:
* фронта (front);
* сервиса аккаунтов (accounts);
* сервиса обналичивания денег (cash);
* сервиса перевода денег между счетами одного или двух аккаунтов (transfer);
* сервиса конвертации валют (exchange);
* сервиса генерации курсов валют (exchange-generator);
* сервиса блокировки подозрительных операций (blocker);
* сервиса уведомлений (notifications).

## Фронт (front)
Фронт (front) — это веб-приложение с клиентским HTML-интерфейсом. Предоставляет следующие HTML-страницы:
* Cтраницу ввода логина/пароля:
  * поле ввода логина;
  * поле ввода пароля;
  * кнопку «Войти», при нажатии на которую происходит аутентификация/авторизация пользователя и редирект на главную страницу.
* Страницу выхода из приложения (разлогинивания) содержит ссылку, при нажатии на которую:
  * пользователь разлогинивается;
  * происходит редирект на страницу ввода логина/пароля.
* Страницу регистрации пользователя в приложении (нового аккаунта):
  * поле ввода фамилии, имени, почты, даты рождения;
  * поле ввода логина, пароля и подтверждения пароля;
  * кнопку «Зарегистрироваться», при нажатии на которую происходит проверка введённых данных и создаётся новый аккаунт с автоматической аутентификацией/авторизацией пользователя и редиректом на главную страницу.
* Главную страницу, которая доступна только после успешной аутентификации/авторизации пользователя:
  * блок настроек аккаунта состоит из: 
    * логина пользователя без возможности редактирования, но с возможностью удаления (если есть хотя бы один ненулевой счёт, то должна появляться ошибка);
    * поля ввода нового пароля и кнопки «Изменить пароль», при нажатии на которую меняется пароль пользователя (пароль должен быть непустой);
    * фамилии, имени, почты (если предполагается отправлять уведомления на почту) и даты рождения с возможностью их редактирования (должна быть предусмотрена валидация: все поля заполнены, возраст старше 18 лет);
    * списка счетов пользователя с возможностью их добавления, редактирования и удаления (у пользователя может быть не более одного счёта в определённой валюте);
    * ссылки на страницу разлогинивания;
  * блок внесения и снятия виртуальных денег состоит из:
    * поля выбора счёта (обязательно);
    * поля ввода суммы снятия (обязательно);
    * кнопок «Положить» и «Снять» (если сумма, которую нужно снять, больше суммы на счёте, то должна появляться ошибка);
  * блок перевода денег между своими счетами состоит из:
    * поля выбора своего счёта для отправки денег (обязательно);
    * поля выбора своего счёта для получения (обязательно);
    * поля ввода суммы перевода (если сумма больше суммы на счёте отправления, то должна появляться ошибка);
    * кнопки, при нажатии на которую осуществляется перевод денег;
  * блок перевода денег на счёт другого аккаунта состоит из:
    * поля выбора своего счёта для отправки денег (обязательно);
    * поля выбора счёта получателя (обязательно, с поиском по аккаунту);
    * поля ввода суммы перевода (если сумма больше суммы на счёте отправления, то должна появляться ошибка);
    * кнопки, при нажатии на которую осуществляется перевод денег;
  * блок курсов валют состоит из:
    * Первый столбец таблицы — валюта;
    * Второй столбец — курс.

## Сервис аккаунтов (accounts)
Сервис аккаунтов хранит информацию о зарегистрированных аккаунтах и счетах в каждом из них (именно в нём хранятся логин/пароль, которые проверяются при аутентификации пользователя).
Фронт выполняет REST-запросы (в формате JSON) из блока настроек аккаунта в сервис Accounts при получении данных аккаунта и данных о счетах, их редактировании, добавлении и удалении.
В свою очередь, accounts выполняет REST-запросы (в формате JSON) в notifications.
Также в accounts приходят запросы при регистрации нового аккаунта (из формы регистрации).

## Сервис обналичивания денег (cash)
Сервис обналичивания денег осуществляет пополнение счёта или снятие денег со счёта.
Фронт выполняет REST-запросы (в формате JSON) из блока внесения и снятия виртуальных денег в сервис cash.
В свою очередь, cash выполняет REST-запросы (в формате JSON) в accounts, blocker и notifications.

## Сервис перевода денег между счетами (transfer)
Сервис перевода денег между счетами осуществляет перевод денег между счетами одного пользователя и между счетами разных пользователей.
Фронт выполняет REST-запросы (в формате JSON) из блока перевода денег между своими счетами и блока перевода денег на счёт другого аккаунта в сервис transfer.
В свою очередь, transfer выполняет REST-запросы (в формате JSON) в accounts, exchange, blocker и notifications.

## Сервис конвертации валют (exchange)
Сервис конвертации валют хранит информацию о конвертации валюты при её покупке/продаже (базовой валютой считается RUB, её конвертация при продаже/покупке равна 1).
Фронт выполняет REST-запросы (в формате JSON) из блока курсов валют в сервис exchange для получения информации о курсах валют.
Сервис генерации курсов валют (exchange-generator)
Сервис генерации курсов валют каждую секунду по расписанию генерирует курсы валют (алгоритм на ваш выбор: Round Robin из файла, БД, случайные значения и т. д.) и выполняет REST-запросы (в формате JSON) в сервис exchange.
Валют должно быть не меньше трёх: RUB, USD, CNY. Базовой валютой считается RUB, то есть при конвертации, например, из USD в CNY сначала USD конвертируется в RUB, а потом RUB в CNY.

## Сервис блокировки подозрительных операций (blocker)
Сервис блокировки подозрительных операций отслеживает подозрительные операции случайным образом.

## Сервис уведомлений (notifications)
Сервис уведомлений отправляет уведомления на почту пользователю о выполненном действии: переводе денег, пополнении счёта, снятии денег со счёта и т. д.

## _Структура проекта_
> Spring Framework<br>
> Java: 21<br>
> СУБД PostgreSQL: 17.5<br>


## _Запуск приложения_
Приложение можно запустить:<br>
* локально<br>
    _java -jar notifications-0.0.1.jar_<br>
    _java -jar blocker-0.0.1.jar_<br>
    _java -jar exchange-0.0.1.jar_<br>
    _java -jar exchange-generator-0.0.1.jar_<br>
    _java -jar accounts-0.0.1.jar_<br>
    _java -jar cash-0.0.1.jar_<br>
    _java -jar transfer-0.0.1.jar_<br>
    _java -jar front-0.0.1.jar_<br>
Локальные СУБД PostrgeSQL17, Keycloak (экспорт realm - realm-export.json)
* в Docker-контейнере<br>
_docker-compose up -d --build_