global:
  keycloak:
    fullnameOverride: "keycloak"
  postgresql:
    auth:
      password: "6zgqWHmj9I"

realm:
  importFromFile: true
replicaCount: 1
keycloak:
  enabled: true
  auth:
    adminUser: admin
    adminPassword: admin
  extraVolumes:
    - name: realm-config
      configMap:
        name: keycloak-config
  extraVolumeMounts:
    - name: realm-config
      mountPath: /opt/bitnami/keycloak/data/import/bankapp-realm.json
      subPath: bankapp-realm.json

  livenessProbe:
    initialDelaySeconds: 300
    timeoutSeconds: 10
    periodSeconds: 10
    failureThreshold: 3
  readinessProbe:
    initialDelaySeconds: 120
    timeoutSeconds: 10
    periodSeconds: 10
    failureThreshold: 3
  image:
    registry: docker.io
    repository: bitnamilegacy/keycloak
    tag: 26.3.3-debian-12-r0
  postgresql:
    image:
      registry: docker.io
      repository: bitnamilegacy/postgresql
      tag: 17.6.0-debian-12-r0
    metrics:
      image:
        registry: docker.io
        repository: bitnamilegacy/postgresql
        tag: 17.6.0-debian-12-r0
    primary:
      persistence:
        storageClass: ""
    livenessProbe:
      initialDelaySeconds: 120
      timeoutSeconds: 10
  keycloakConfigCli:
    enabled: true
    image:
      registry: docker.io
      repository: bitnamilegacy/keycloak-config-cli
      tag: 6.4.0-debian-12-r11
    #args:
    #  - 'bin/kcadm.sh create realms -f /opt/bitnami/keycloak/realm/bankapp-realm.json'
    extraVolumes:
      - name: realm-config
        configMap:
          name: keycloak-config
    extraVolumeMounts:
      - name: realm-config
        mountPath: /opt/bitnami/keycloak/realm
        readOnly: true
    extraEnvVars:
      - name: IMPORT_FILES_LOCATIONS
        value: "/opt/bitnami/keycloak/realm/bankapp-realm.json"
      - name: KEYCLOAK_URL
        value: "http://keycloak:80"
      - name: KEYCLOAK_USER
        value: "admin"
      - name: KEYCLOAK_PASSWORD
        value: "admin"
      - name: KEYCLOAK_AVAILABILITY_CHECK_ENABLED
        value: "true"
      - name: KEYCLOAK_AVAILABILITY_CHECK_TIMEOUT
        value: "300s"
      - name: IMPORT_MANAGED_AUTHENTICATION_FLOW
        value: "FULL"
      - name: IMPORT_SKIP_ATTRIBUTES_FOR_FEDERATED_USER
        value: "true"
      - name: IMPORT_MANAGED_PARTIAL_IMPORT
        value: "true"

spec:
  template:
    spec:
      containers:
        - name: postgresql
          image: docker.io/bitnamilegacy/postgresql:17.6.0-debian-12-r0

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  create: true
  automount: true
  annotations: {}
  name: ""

podAnnotations: {}
podLabels: {}

podSecurityContext: {}

securityContext: {}

service:
  type: ClusterIP
  port: 8080

containerPorts:
  http: 8080

ingress:
  enabled: true
  className: "nginx"
  annotations:
    kubernetes.io/ingress.class: nginx
    nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
  hosts:
    - host: keycloak.local
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls: []

httpRoute:
  enabled: false
  annotations: {}
  parentRefs:
    - name: gateway
      sectionName: http
  hostnames:
    - keycloak.local
  rules:
    - matches:
        - path:
            type: PathPrefix
            value: /headers

resources: {}

livenessProbe:
  httpGet:
    path: /
    port: http
readinessProbe:
  httpGet:
    path: /
    port: http

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

volumes: []

volumeMounts: []

nodeSelector: {}

tolerations: []

affinity: {}